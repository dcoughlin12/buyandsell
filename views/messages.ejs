<!DOCTYPE html>
<html lang="en">
<head>
  <title>Messages</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <link rel = "stylesheet" href="/styles/index.css">
  <link rel = "stylesheet" href="/styles/messages.css">
  <link href="https://fonts.googleapis.com/css2?family=Baloo+Bhaina+2:wght@400;500;600;700;800&display=swap" rel="stylesheet">

</head>
<body>
  <%- include('partials/_header') %>
  <main style="margin: 1em;">
      <h3 id="msgTitle"><b>Messages</b></h3>

      <% for (let msg of listOfMessages) { %>
      <div class="listedMessages">
        <div class="panel panel-success msgListingImage">
          <div id="msgTitleHeading" class="panel-heading"><%= msg.title %></div>
          <div id="imageSpace" class="panel-body"><img id="thumbImage" src="<%= msg.image_url%>" class="img-responsive" style="width:100%" alt="Image"></div>
          <div id="footerPrice" class="panel-footer">$<%= msg.price %></div>
          <div class="panel-footer"><%= msg.description %></div>
        </div>
        <div class="messageFeedText">
        <% if ( msg.sender_name !==  username  ){ %>
            <p> FROM: <%= msg.sender_name  %> </p>
        <% } else{ %>
            <p id="sentMsg"> Message Sent  ✔️</p>
          <% } %>
          <p>"<%= msg.message %>"</p>

          <form class="messageForm" action="/messagesResponses/<%= msg.message_id %>" method="POST">
            <textarea class="messageInput" name="text" placeholder="Respond here..." id="messageForm"></textarea>
              <button id="messageButton" type="submit">Send</button>
            </div>
          </form>
        </div>
      </div>
      <% } %>


    </main>
</body>
</html>
